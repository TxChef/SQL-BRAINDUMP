SELECT A.PROJECT_ID AS "Project ID"
     , A.EFF_STATUS AS "Project Status"
     , A.DESCR AS "Project Description"
     , A.PROJECT_TYPE AS "Project Type"
     , B.PRJ_LEVEL1_CF_VAL AS "Business Unit"
     , B.PRJ_LEVEL2_CF_VAL AS "Operating Unit"
     , B.PRJ_LEVEL3_CF_VAL AS "Product"
     , C.DESCR AS "Product Description"
     , E.NAME AS "Project Manager"
     , A.LCRA_FUND_SOURCE AS "LCRA Fund Source"
     , Y.DESCR50 AS "Fund Source Descr"
     --, INITCAP(SUBSTR(G.TREE_NODE, - INSTR(REVERSE(G.TREE_NODE), '_') + 1)) AS "Rate Designation"
     , G.TREE_NODE AS "Rate Designation" 
     , X.DESCR AS "Rate Description"
     , D.PLAN_STARTDT As "Start Date" 
     , D. TEAM_MEMBER AS "ID"     
  FROM  
       (((((PS_PROJECT A LEFT OUTER JOIN  PS_PSA_ORGPRJ_DEFN B ON  A.BUSINESS_UNIT = B.BUSINESS_UNIT AND A.PROJECT_ID = B.PROJECT_ID ) 
                          LEFT OUTER JOIN  PS_PROJECT_TEAM D ON  A.BUSINESS_UNIT = D.BUSINESS_UNIT AND A.PROJECT_ID = D.PROJECT_ID ) 
                          LEFT OUTER JOIN  PS_EMP_NAME_VW_L E ON  D.TEAM_MEMBER = E.EMPLID ) 
                          LEFT OUTER JOIN  PSTREELEAF F ON  A.PROJECT_ID BETWEEN F.RANGE_FROM AND F.RANGE_TO )
                          LEFT OUTER JOIN PS_LCRA_FUND_SRC Y ON A.LCRA_FUND_SOURCE = Y.LCRA_FUND_SOURCE),
       (PSTREENODE G LEFT OUTER JOIN PS_PROJECT X ON G.TREE_NODE = X.PROJECT_ID),
       PS_PRODUCT_TBL C                      
  WHERE ( B.EFFDT = 
        (SELECT MAX(B_ED.EFFDT) FROM PS_PSA_ORGPRJ_DEFN B_ED 
        WHERE B.BUSINESS_UNIT = B_ED.BUSINESS_UNIT 
          AND B.PROJECT_ID = B_ED.PROJECT_ID 
          AND B_ED.EFFDT <= SYSDATE) 
     AND C.EFFDT = 
        (SELECT MAX(C_ED.EFFDT) FROM PS_PRODUCT_TBL C_ED 
        WHERE C.SETID = C_ED.SETID 
          AND C.PRODUCT = C_ED.PRODUCT 
          AND C_ED.EFFDT <= SYSDATE) 
     AND B.PRJ_LEVEL3_CF_VAL = C.PRODUCT 
     AND B.PRJ_LEVEL2_CF_VAL IN ('BSSCO','COMCO','GENTX','TENCO','TSCRP','WPSCO','FPPCO','WTRCO','WSCE1','CRLT1') 
     AND F.EFFDT = 
        (SELECT MAX(F_ED.EFFDT) FROM PSTREELEAF F_ED 
        WHERE F.SETID = F_ED.SETID 
          AND F.SETCNTRLVALUE = F_ED.SETCNTRLVALUE 
          AND F.TREE_NAME = F_ED.TREE_NAME 
          AND F_ED.EFFDT <= SYSDATE) 
     AND F.TREE_NAME = 'CIP_GEN_ADM' 
     AND F.TREE_NAME = G.TREE_NAME 
     AND F.TREE_NODE_NUM = G.TREE_NODE_NUM 
     AND G.EFFDT = F.EFFDT)
     and A.PROJECT_ID = '1005486'
     AND D.PLAN_STARTDT =(SELECT MAX(D.PLAN_STARTDT) FROM PS_PROJECT_TEAM);
     --WHERE PLAN_STARTDT <=SYSDATE);
     